[gd_scene load_steps=7 format=3 uid="uid://cavern3kaillouxmap"]

[ext_resource type="PackedScene" uid="uid://bqr5c8j2xk3yp" path="res://scenes/player/player.tscn" id="1_player"]
[ext_resource type="PackedScene" uid="uid://cnpc8kailloux3" path="res://scenes/npcs/kaillou_npc.tscn" id="2_npc"]
[ext_resource type="PackedScene" uid="uid://dchest3kailloux" path="res://scenes/world/objects/chest.tscn" id="3_chest"]
[ext_resource type="PackedScene" uid="uid://enemy3kailloux" path="res://scenes/enemies/enemy_base.tscn" id="4_enemy"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_platform"]
size = Vector2(200, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall"]
size = Vector2(32, 400)

[node name="ForgottenCaverns" type="Node2D"]

[node name="ParallaxBackground" type="ParallaxBackground" parent="."]

[node name="ParallaxLayer" type="ParallaxLayer" parent="ParallaxBackground"]
motion_scale = Vector2(0.5, 0.5)

[node name="Background" type="ColorRect" parent="ParallaxBackground/ParallaxLayer"]
offset_left = -500.0
offset_top = -400.0
offset_right = 2500.0
offset_bottom = 800.0
color = Color(0.08, 0.1, 0.14, 1)

[node name="BackgroundGlow1" type="ColorRect" parent="ParallaxBackground/ParallaxLayer"]
offset_left = 200.0
offset_top = 100.0
offset_right = 500.0
offset_bottom = 350.0
color = Color(0.15, 0.2, 0.3, 0.3)

[node name="BackgroundGlow2" type="ColorRect" parent="ParallaxBackground/ParallaxLayer"]
offset_left = 1000.0
offset_top = 50.0
offset_right = 1400.0
offset_bottom = 300.0
color = Color(0.2, 0.15, 0.25, 0.25)

[node name="Ground" type="Node2D" parent="."]

[node name="MainFloor" type="StaticBody2D" parent="Ground"]
position = Vector2(500, 450)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ground/MainFloor"]
shape = SubResource("RectangleShape2D_platform")
scale = Vector2(8, 1)

[node name="FloorVisual" type="ColorRect" parent="Ground/MainFloor"]
offset_left = -800.0
offset_top = -16.0
offset_right = 800.0
offset_bottom = 200.0
color = Color(0.2, 0.22, 0.25, 1)

[node name="FloorTop" type="ColorRect" parent="Ground/MainFloor"]
offset_left = -800.0
offset_top = -16.0
offset_right = 800.0
offset_bottom = 0.0
color = Color(0.35, 0.4, 0.45, 1)

[node name="Platforms" type="Node2D" parent="."]

[node name="Platform1" type="StaticBody2D" parent="Platforms"]
position = Vector2(200, 350)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Platforms/Platform1"]
shape = SubResource("RectangleShape2D_platform")

[node name="Visual" type="ColorRect" parent="Platforms/Platform1"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = 16.0
color = Color(0.25, 0.28, 0.32, 1)

[node name="TopLine" type="ColorRect" parent="Platforms/Platform1"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = -12.0
color = Color(0.4, 0.45, 0.5, 1)

[node name="Platform2" type="StaticBody2D" parent="Platforms"]
position = Vector2(500, 280)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Platforms/Platform2"]
shape = SubResource("RectangleShape2D_platform")
scale = Vector2(1.5, 1)

[node name="Visual" type="ColorRect" parent="Platforms/Platform2"]
offset_left = -150.0
offset_top = -16.0
offset_right = 150.0
offset_bottom = 16.0
color = Color(0.25, 0.28, 0.32, 1)

[node name="TopLine" type="ColorRect" parent="Platforms/Platform2"]
offset_left = -150.0
offset_top = -16.0
offset_right = 150.0
offset_bottom = -12.0
color = Color(0.4, 0.45, 0.5, 1)

[node name="Platform3" type="StaticBody2D" parent="Platforms"]
position = Vector2(850, 350)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Platforms/Platform3"]
shape = SubResource("RectangleShape2D_platform")

[node name="Visual" type="ColorRect" parent="Platforms/Platform3"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = 16.0
color = Color(0.25, 0.28, 0.32, 1)

[node name="TopLine" type="ColorRect" parent="Platforms/Platform3"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = -12.0
color = Color(0.4, 0.45, 0.5, 1)

[node name="Platform4" type="StaticBody2D" parent="Platforms"]
position = Vector2(1150, 220)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Platforms/Platform4"]
shape = SubResource("RectangleShape2D_platform")
scale = Vector2(1.2, 1)

[node name="Visual" type="ColorRect" parent="Platforms/Platform4"]
offset_left = -120.0
offset_top = -16.0
offset_right = 120.0
offset_bottom = 16.0
color = Color(0.25, 0.28, 0.32, 1)

[node name="TopLine" type="ColorRect" parent="Platforms/Platform4"]
offset_left = -120.0
offset_top = -16.0
offset_right = 120.0
offset_bottom = -12.0
color = Color(0.4, 0.45, 0.5, 1)

[node name="Platform5" type="StaticBody2D" parent="Platforms"]
position = Vector2(1500, 320)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Platforms/Platform5"]
shape = SubResource("RectangleShape2D_platform")

[node name="Visual" type="ColorRect" parent="Platforms/Platform5"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = 16.0
color = Color(0.25, 0.28, 0.32, 1)

[node name="TopLine" type="ColorRect" parent="Platforms/Platform5"]
offset_left = -100.0
offset_top = -16.0
offset_right = 100.0
offset_bottom = -12.0
color = Color(0.4, 0.45, 0.5, 1)

[node name="Walls" type="Node2D" parent="."]

[node name="WallLeft" type="StaticBody2D" parent="Walls"]
position = Vector2(-50, 250)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallLeft"]
shape = SubResource("RectangleShape2D_wall")

[node name="Visual" type="ColorRect" parent="Walls/WallLeft"]
offset_left = -16.0
offset_top = -200.0
offset_right = 16.0
offset_bottom = 200.0
color = Color(0.18, 0.2, 0.22, 1)

[node name="WallRight" type="StaticBody2D" parent="Walls"]
position = Vector2(1850, 250)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallRight"]
shape = SubResource("RectangleShape2D_wall")

[node name="Visual" type="ColorRect" parent="Walls/WallRight"]
offset_left = -16.0
offset_top = -200.0
offset_right = 16.0
offset_bottom = 200.0
color = Color(0.18, 0.2, 0.22, 1)

[node name="Decorations" type="Node2D" parent="."]
z_index = -2

[node name="Stalactite1" type="ColorRect" parent="Decorations"]
offset_left = 150.0
offset_top = -50.0
offset_right = 170.0
offset_bottom = 30.0
color = Color(0.3, 0.32, 0.35, 1)

[node name="Stalactite2" type="ColorRect" parent="Decorations"]
offset_left = 400.0
offset_top = -50.0
offset_right = 425.0
offset_bottom = 50.0
color = Color(0.28, 0.3, 0.33, 1)

[node name="Stalactite3" type="ColorRect" parent="Decorations"]
offset_left = 700.0
offset_top = -50.0
offset_right = 720.0
offset_bottom = 20.0
color = Color(0.3, 0.32, 0.35, 1)

[node name="Stalactite4" type="ColorRect" parent="Decorations"]
offset_left = 1100.0
offset_top = -50.0
offset_right = 1130.0
offset_bottom = 60.0
color = Color(0.28, 0.3, 0.33, 1)

[node name="Stalactite5" type="ColorRect" parent="Decorations"]
offset_left = 1400.0
offset_top = -50.0
offset_right = 1420.0
offset_bottom = 10.0
color = Color(0.3, 0.32, 0.35, 1)

[node name="GlowOrb1" type="ColorRect" parent="Decorations"]
offset_left = 300.0
offset_top = 200.0
offset_right = 320.0
offset_bottom = 220.0
color = Color(0.4, 0.8, 0.9, 0.5)

[node name="GlowOrb2" type="ColorRect" parent="Decorations"]
offset_left = 900.0
offset_top = 150.0
offset_right = 915.0
offset_bottom = 165.0
color = Color(0.5, 0.4, 0.9, 0.5)

[node name="GlowOrb3" type="ColorRect" parent="Decorations"]
offset_left = 1300.0
offset_top = 250.0
offset_right = 1318.0
offset_bottom = 268.0
color = Color(0.4, 0.8, 0.9, 0.4)

[node name="Player" parent="." instance=ExtResource("1_player")]
position = Vector2(100, 400)

[node name="Enemies" type="Node2D" parent="."]

[node name="Enemy1" parent="Enemies" instance=ExtResource("4_enemy")]
position = Vector2(350, 430)
patrol_distance = 80.0

[node name="Enemy2" parent="Enemies" instance=ExtResource("4_enemy")]
position = Vector2(700, 430)
patrol_distance = 100.0

[node name="Enemy3" parent="Enemies" instance=ExtResource("4_enemy")]
position = Vector2(500, 260)
patrol_distance = 60.0

[node name="Enemy4" parent="Enemies" instance=ExtResource("4_enemy")]
position = Vector2(1100, 430)
patrol_distance = 120.0

[node name="NPCs" type="Node2D" parent="."]

[node name="NPC_Elder" parent="NPCs" instance=ExtResource("2_npc")]
position = Vector2(200, 330)
kaillou_type = 2
personality = "wise"
dialogue_lines = Array[String](["Ces cavernes... elles etaient autrefois paisibles.", "La corruption s'est repandue depuis les profondeurs.", "Mefie-toi des creatures aux yeux rouges."])

[node name="NPC_Mysterious" parent="NPCs" instance=ExtResource("2_npc")]
position = Vector2(1150, 200)
kaillou_type = 3
personality = "mysterious"
dialogue_lines = Array[String](["Tu cherches quelque chose, petit caillou?", "Les reponses se trouvent plus bas...", "Si tu survis jusque-la."])

[node name="Chests" type="Node2D" parent="."]

[node name="ChestGem" parent="Chests" instance=ExtResource("3_chest")]
position = Vector2(850, 330)
content_item_id = "small_gem"

[node name="ChestCandle" parent="Chests" instance=ExtResource("3_chest")]
position = Vector2(1500, 300)
content_item_id = "candle"
